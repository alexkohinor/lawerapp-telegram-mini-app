# ğŸ¤– AI Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² LawerApp Telegram Mini App

## ğŸ“‹ ĞĞ±Ğ·Ğ¾Ñ€ AI Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

**LawerApp** Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ AI Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ¿Ñ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ²Ñ‹Ñ… ĞºĞ¾Ğ½ÑÑƒĞ»ÑŒÑ‚Ğ°Ñ†Ğ¸Ğ¹. Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ²ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ°Ğ³ĞµĞ½Ñ‚Ğ½ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ, RAG (Retrieval-Augmented Generation) Ğ¸ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ Ñ€Ğ¾ÑÑĞ¸Ğ¹ÑĞºĞ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ°.

---

## ğŸ¯ AI Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### **1. ĞœĞ½Ğ¾Ğ³Ğ¾Ğ°Ğ³ĞµĞ½Ñ‚Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI Agents Ecosystem                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Legal         â”‚  â”‚   Document      â”‚  â”‚   Dispute   â”‚  â”‚
â”‚  â”‚   Advisor       â”‚  â”‚   Generator     â”‚  â”‚   Analyst   â”‚  â”‚
â”‚  â”‚   (GPT-4)       â”‚  â”‚   (GPT-4)       â”‚  â”‚   (Claude)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Personal      â”‚  â”‚   Payment       â”‚  â”‚   Notificationâ”‚  â”‚
â”‚  â”‚   Assistant     â”‚  â”‚   Advisor       â”‚  â”‚   Agent     â”‚  â”‚
â”‚  â”‚   (GPT-4)       â”‚  â”‚   (Claude)      â”‚  â”‚   (GPT-4)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **2. RAG ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ TimeWeb Cloud**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RAG Pipeline (TimeWeb Cloud)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   User Query    â”‚  â”‚   Embedding     â”‚  â”‚   Vector    â”‚  â”‚
â”‚  â”‚   Processing    â”‚  â”‚   Generation    â”‚  â”‚   Search    â”‚  â”‚
â”‚  â”‚   (Frontend)    â”‚  â”‚   (TimeWeb)     â”‚  â”‚   (TimeWeb) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Context       â”‚  â”‚   LLM           â”‚  â”‚   Response  â”‚  â”‚
â”‚  â”‚   Retrieval     â”‚  â”‚   Generation    â”‚  â”‚   Delivery  â”‚  â”‚
â”‚  â”‚   (TimeWeb)     â”‚  â”‚   (TimeWeb)     â”‚  â”‚   (Frontend)â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

### **1. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹**

```bash
# AI ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
npm install openai anthropic

# TimeWeb Cloud Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ
npm install axios

# Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹
npm install uuid
npm install -D @types/uuid
```

### **2. ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ AI ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²**

#### **OpenAI Service**
```typescript
// src/lib/ai/openai-service.ts
import OpenAI from 'openai';

export class OpenAIService {
  private client: OpenAI;
  
  constructor() {
    this.client = new OpenAI({
      apiKey: process.env.OPENAI_API_KEY,
    });
  }
  
  async generateResponse(
    messages: OpenAI.Chat.Completions.ChatCompletionMessageParam[],
    options?: {
      model?: string;
      temperature?: number;
      maxTokens?: number;
    }
  ): Promise<string> {
    try {
      const response = await this.client.chat.completions.create({
        model: options?.model || 'gpt-4',
        messages,
        temperature: options?.temperature || 0.7,
        max_tokens: options?.maxTokens || 1000,
      });
      
      return response.choices[0].message.content || '';
    } catch (error) {
      console.error('OpenAI API error:', error);
      throw new Error('Failed to generate AI response');
    }
  }
  
  async generateEmbedding(text: string): Promise<number[]> {
    try {
      const response = await this.client.embeddings.create({
        model: 'text-embedding-3-large',
        input: text,
      });
      
      return response.data[0].embedding;
    } catch (error) {
      console.error('OpenAI Embedding error:', error);
      throw new Error('Failed to generate embedding');
    }
  }
}
```

#### **Anthropic Service**
```typescript
// src/lib/ai/anthropic-service.ts
import Anthropic from '@anthropic-ai/sdk';

export class AnthropicService {
  private client: Anthropic;
  
  constructor() {
    this.client = new Anthropic({
      apiKey: process.env.ANTHROPIC_API_KEY,
    });
  }
  
  async generateResponse(
    prompt: string,
    options?: {
      model?: string;
      temperature?: number;
      maxTokens?: number;
    }
  ): Promise<string> {
    try {
      const response = await this.client.messages.create({
        model: options?.model || 'claude-3-sonnet-20240229',
        max_tokens: options?.maxTokens || 1000,
        temperature: options?.temperature || 0.7,
        messages: [
          {
            role: 'user',
            content: prompt,
          },
        ],
      });
      
      return response.content[0].type === 'text' 
        ? response.content[0].text 
        : '';
    } catch (error) {
      console.error('Anthropic API error:', error);
      throw new Error('Failed to generate AI response');
    }
  }
}
```

### **3. RAG ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°**

#### **TimeWeb Cloud Vector Store**
```typescript
// src/lib/ai/timeweb-vector-store.ts
import axios from 'axios';

export class TimeWebVectorStore {
  private apiKey: string;
  private baseUrl: string;
  
  constructor() {
    this.apiKey = process.env.TIMEWEB_API_KEY!;
    this.baseUrl = process.env.TIMEWEB_API_URL || 'https://api.timeweb.cloud';
  }
  
  async storeDocument(
    id: string,
    text: string,
    metadata: Record<string, any>,
    embedding: number[]
  ): Promise<void> {
    try {
      await axios.post(`${this.baseUrl}/v1/vectors/store`, {
        id,
        text,
        embedding,
        metadata: {
          text,
          ...metadata,
        },
      }, {
        headers: {
          'Authorization': `Bearer ${this.apiKey}`,
          'Content-Type': 'application/json',
        },
      });
    } catch (error) {
      console.error('TimeWeb vector store error:', error);
      throw new Error('Failed to store document in TimeWeb Cloud');
    }
  }
  
  async searchSimilar(
    embedding: number[],
    topK: number = 5,
    filter?: Record<string, any>
  ): Promise<Array<{ text: string; metadata: Record<string, any>; score: number }>> {
    try {
      const response = await axios.post(`${this.baseUrl}/v1/vectors/search`, {
        vector: embedding,
        topK,
        filter,
        includeMetadata: true,
      }, {
        headers: {
          'Authorization': `Bearer ${this.apiKey}`,
          'Content-Type': 'application/json',
        },
      });
      
      return response.data.matches.map((match: any) => ({
        text: match.metadata.text,
        metadata: match.metadata,
        score: match.score,
      }));
    } catch (error) {
      console.error('TimeWeb vector search error:', error);
      throw new Error('Failed to search similar documents in TimeWeb Cloud');
    }
  }
  
  async generateEmbedding(text: string): Promise<number[]> {
    try {
      const response = await axios.post(`${this.baseUrl}/v1/embeddings/generate`, {
        text,
        model: 'text-embedding-3-large',
      }, {
        headers: {
          'Authorization': `Bearer ${this.apiKey}`,
          'Content-Type': 'application/json',
        },
      });
      
      return response.data.embedding;
    } catch (error) {
      console.error('TimeWeb embedding generation error:', error);
      throw new Error('Failed to generate embedding in TimeWeb Cloud');
    }
  }
}
```

#### **RAG Service Ñ TimeWeb Cloud**
```typescript
// src/lib/ai/rag-service.ts
import { OpenAIService } from './openai-service';
import { TimeWebVectorStore } from './timeweb-vector-store';

export class RAGService {
  private openaiService: OpenAIService;
  private vectorStore: TimeWebVectorStore;
  
  constructor() {
    this.openaiService = new OpenAIService();
    this.vectorStore = new TimeWebVectorStore();
  }
  
  async getLegalConsultation(query: string): Promise<string> {
    try {
      // 1. Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ embedding Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ñ‡ĞµÑ€ĞµĞ· TimeWeb Cloud
      const queryEmbedding = await this.vectorStore.generateEmbedding(query);
      
      // 2. Ğ˜Ñ‰ĞµĞ¼ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ² TimeWeb Cloud
      const similarDocs = await this.vectorStore.searchSimilar(queryEmbedding, 5);
      
      // 3. Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµĞ¼ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚
      const context = similarDocs
        .map(doc => doc.text)
        .join('\n\n');
      
      // 4. Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¾Ñ‚Ğ²ĞµÑ‚ Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ¼
      const messages: OpenAI.Chat.Completions.ChatCompletionMessageParam[] = [
        {
          role: 'system',
          content: `Ğ¢Ñ‹ - ÑĞºÑĞ¿ĞµÑ€Ñ‚ Ğ¿Ğ¾ Ñ€Ğ¾ÑÑĞ¸Ğ¹ÑĞºĞ¾Ğ¼Ñƒ Ğ¿Ñ€Ğ°Ğ²Ñƒ, ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒÑÑ‰Ğ¸Ğ¹ÑÑ Ğ½Ğ° Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ°Ğ² Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ¸Ñ‚ĞµĞ»ĞµĞ¹.

ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ¸Ğ· Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ²Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ñ‹ Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹:
${context}

Ğ’Ğ°Ğ¶Ğ½Ğ¾:
- ĞÑ‚Ğ²ĞµÑ‡Ğ°Ğ¹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ñ€Ğ¾ÑÑĞ¸Ğ¹ÑĞºĞ¾Ğ³Ğ¾ Ğ·Ğ°ĞºĞ¾Ğ½Ğ¾Ğ´Ğ°Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ°
- Ğ£ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ğ¹ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ ÑÑ‚Ğ°Ñ‚ÑŒĞ¸ Ğ·Ğ°ĞºĞ¾Ğ½Ğ¾Ğ²
- ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´Ğ°Ğ¹ Ğ¾ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ĞºĞ¾Ğ½ÑÑƒĞ»ÑŒÑ‚Ğ°Ñ†Ğ¸Ğ¸ Ñ ÑÑ€Ğ¸ÑÑ‚Ğ¾Ğ¼
- Ğ‘ÑƒĞ´ÑŒ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¼ Ğ¸ Ğ¿Ñ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼`,
        },
        {
          role: 'user',
          content: query,
        },
      ];
      
      return await this.openaiService.generateResponse(messages, {
        model: 'gpt-4',
        temperature: 0.3,
        maxTokens: 1500,
      });
    } catch (error) {
      console.error('RAG service error:', error);
      throw new Error('Failed to get legal consultation');
    }
  }
}
```

### **4. AI ĞĞ³ĞµĞ½Ñ‚Ñ‹**

#### **Legal Advisor Agent**
```typescript
// src/lib/ai/agents/legal-advisor-agent.ts
import { RAGService } from '../rag-service';

export class LegalAdvisorAgent {
  private ragService: RAGService;
  
  constructor() {
    this.ragService = new RAGService();
  }
  
  async provideLegalAdvice(query: string): Promise<{
    advice: string;
    confidence: number;
    sources: string[];
  }> {
    try {
      const advice = await this.ragService.getLegalConsultation(query);
      
      // ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°
      const confidence = this.analyzeConfidence(advice);
      
      // Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸
      const sources = this.extractSources(advice);
      
      return {
        advice,
        confidence,
        sources,
      };
    } catch (error) {
      console.error('Legal advisor error:', error);
      throw new Error('Failed to provide legal advice');
    }
  }
  
  private analyzeConfidence(advice: string): number {
    // ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ ÑĞ²Ñ€Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸
    const confidenceIndicators = [
      'ÑÑ‚Ğ°Ñ‚ÑŒÑ', 'Ğ·Ğ°ĞºĞ¾Ğ½', 'ĞºĞ¾Ğ´ĞµĞºÑ', 'Ğ¿Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ',
      'Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¾', 'ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾', 'Ğ¿Ñ€ĞµĞ´ÑƒÑĞ¼Ğ¾Ñ‚Ñ€ĞµĞ½Ğ¾'
    ];
    
    const uncertaintyIndicators = [
      'Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾', 'Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ', 'Ğ½Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¾',
      'Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ ÑƒÑ‚Ğ¾Ñ‡Ğ½ĞµĞ½Ğ¸Ñ', 'Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ'
    ];
    
    const confidenceScore = confidenceIndicators.reduce((score, indicator) => {
      return score + (advice.toLowerCase().includes(indicator) ? 1 : 0);
    }, 0);
    
    const uncertaintyScore = uncertaintyIndicators.reduce((score, indicator) => {
      return score + (advice.toLowerCase().includes(indicator) ? 1 : 0);
    }, 0);
    
    return Math.max(0, Math.min(1, (confidenceScore - uncertaintyScore) / 10));
  }
  
  private extractSources(advice: string): string[] {
    const sources: string[] = [];
    const lawPattern = /(?:ÑÑ‚\.|ÑÑ‚Ğ°Ñ‚ÑŒÑ|Ğ·Ğ°ĞºĞ¾Ğ½|ĞºĞ¾Ğ´ĞµĞºÑ)\s*(\d+)/gi;
    const matches = advice.match(lawPattern);
    
    if (matches) {
      sources.push(...matches);
    }
    
    return sources;
  }
}
```

#### **Document Generator Agent**
```typescript
// src/lib/ai/agents/document-generator-agent.ts
import { OpenAIService } from '../openai-service';

export class DocumentGeneratorAgent {
  private openaiService: OpenAIService;
  
  constructor() {
    this.openaiService = new OpenAIService();
  }
  
  async generateDocument(
    type: 'claim' | 'complaint' | 'contract',
    data: Record<string, any>
  ): Promise<{
    content: string;
    metadata: Record<string, any>;
  }> {
    try {
      const template = this.getTemplate(type);
      const prompt = this.buildPrompt(template, data);
      
      const messages: OpenAI.Chat.Completions.ChatCompletionMessageParam[] = [
        {
          role: 'system',
          content: `Ğ¢Ñ‹ - ÑĞºÑĞ¿ĞµÑ€Ñ‚ Ğ¿Ğ¾ ÑĞ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ²Ñ‹Ñ… Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ². 
          
Ğ¢Ğ²Ğ¾Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° - ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ²Ğ¾Ğ¹ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ¿Ñ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….

Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Ğ¾Ñ„Ğ¸Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ
- Ğ¡Ğ¾Ğ±Ğ»ÑĞ´Ğ°Ğ¹ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°
- Ğ’ĞºĞ»ÑÑ‡Ğ¸ Ğ²ÑĞµ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ Ñ€ĞµĞºĞ²Ğ¸Ğ·Ğ¸Ñ‚Ñ‹
- Ğ¡ÑÑ‹Ğ»Ğ°Ğ¹ÑÑ Ğ½Ğ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑŒĞ¸ Ğ·Ğ°ĞºĞ¾Ğ½Ğ¾Ğ²
- Ğ‘ÑƒĞ´ÑŒ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¼ Ğ¸ Ğ¿Ñ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼`,
        },
        {
          role: 'user',
          content: prompt,
        },
      ];
      
      const content = await this.openaiService.generateResponse(messages, {
        model: 'gpt-4',
        temperature: 0.2,
        maxTokens: 2000,
      });
      
      return {
        content,
        metadata: {
          type,
          generatedAt: new Date().toISOString(),
          data,
        },
      };
    } catch (error) {
      console.error('Document generator error:', error);
      throw new Error('Failed to generate document');
    }
  }
  
  private getTemplate(type: string): string {
    const templates = {
      claim: `
ĞŸĞ Ğ•Ğ¢Ğ•ĞĞ—Ğ˜Ğ¯

Ğ’ {{sellerName}}
ĞÑ‚ {{buyerName}}

{{buyerAddress}}

{{date}}

ĞŸĞ Ğ•Ğ¢Ğ•ĞĞ—Ğ˜Ğ¯

{{disputeDescription}}

ĞĞ° Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¸ ÑÑ‚. 18 Ğ—Ğ°ĞºĞ¾Ğ½Ğ° Ğ Ğ¤ "Ğ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ°Ğ² Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ¸Ñ‚ĞµĞ»ĞµĞ¹" Ñ‚Ñ€ĞµĞ±ÑƒÑ:

{{demands}}

Ğ’ ÑĞ»ÑƒÑ‡Ğ°Ğµ Ğ½ĞµÑƒĞ´Ğ¾Ğ²Ğ»ĞµÑ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ¸Ñ Ğ¿Ñ€ĞµÑ‚ĞµĞ½Ğ·Ğ¸Ğ¸ Ğ² Ñ‚ĞµÑ‡ĞµĞ½Ğ¸Ğµ {{deadline}} Ğ´Ğ½ĞµĞ¹, Ğ±ÑƒĞ´Ñƒ Ğ²Ñ‹Ğ½ÑƒĞ¶Ğ´ĞµĞ½ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ¸Ñ‚ÑŒÑÑ Ğ² ÑÑƒĞ´.

ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ:
{{attachments}}

{{buyerSignature}}
      `,
      complaint: `
Ğ˜Ğ¡ĞšĞĞ’ĞĞ• Ğ—ĞĞ¯Ğ’Ğ›Ğ•ĞĞ˜Ğ•

Ğ’ {{courtName}}
Ğ˜ÑÑ‚ĞµÑ†: {{plaintiffName}}
{{plaintiffAddress}}

ĞÑ‚Ğ²ĞµÑ‚Ñ‡Ğ¸Ğº: {{defendantName}}
{{defendantAddress}}

Ğ¦ĞµĞ½Ğ° Ğ¸ÑĞºĞ°: {{amount}} Ñ€ÑƒĞ±Ğ»ĞµĞ¹

Ğ˜Ğ¡ĞšĞĞ’ĞĞ• Ğ—ĞĞ¯Ğ’Ğ›Ğ•ĞĞ˜Ğ•

{{caseDescription}}

ĞŸÑ€Ğ°Ğ²Ğ¾Ğ²Ñ‹Ğµ Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
{{legalBasis}}

ĞŸÑ€Ğ¾ÑˆÑƒ ÑÑƒĞ´:
{{claims}}

ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ:
{{attachments}}

{{date}}
{{plaintiffSignature}}
      `,
    };
    
    return templates[type as keyof typeof templates] || '';
  }
  
  private buildPrompt(template: string, data: Record<string, any>): string {
    let prompt = template;
    
    // Ğ—Ğ°Ğ¼ĞµĞ½ÑĞµĞ¼ Ğ¿Ğ»ĞµĞ¹ÑÑ…Ğ¾Ğ»Ğ´ĞµÑ€Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸
    Object.entries(data).forEach(([key, value]) => {
      const placeholder = `{{${key}}}`;
      prompt = prompt.replace(new RegExp(placeholder, 'g'), String(value));
    });
    
    return `Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ²Ğ¾Ğ¹ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ³Ğ¾ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ° Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:

Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½:
${prompt}

Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:
${JSON.stringify(data, null, 2)}

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚.`;
  }
}
```

### **5. API Endpoints**

#### **AI Consultation API**
```typescript
// src/app/api/ai/consultation/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { LegalAdvisorAgent } from '@/lib/ai/agents/legal-advisor-agent';

export async function POST(request: NextRequest) {
  try {
    const { query, userId } = await request.json();
    
    if (!query) {
      return NextResponse.json(
        { error: 'Query is required' },
        { status: 400 }
      );
    }
    
    const legalAdvisor = new LegalAdvisorAgent();
    const result = await legalAdvisor.provideLegalAdvice(query);
    
    // Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµĞ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸
    console.log('AI consultation:', {
      userId,
      query: query.substring(0, 100),
      confidence: result.confidence,
      timestamp: new Date().toISOString(),
    });
    
    return NextResponse.json({
      advice: result.advice,
      confidence: result.confidence,
      sources: result.sources,
    });
  } catch (error) {
    console.error('AI consultation error:', error);
    return NextResponse.json(
      { error: 'Failed to get AI consultation' },
      { status: 500 }
    );
  }
}
```

#### **Document Generation API**
```typescript
// src/app/api/ai/generate-document/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { DocumentGeneratorAgent } from '@/lib/ai/agents/document-generator-agent';

export async function POST(request: NextRequest) {
  try {
    const { type, data, userId } = await request.json();
    
    if (!type || !data) {
      return NextResponse.json(
        { error: 'Type and data are required' },
        { status: 400 }
      );
    }
    
    const documentGenerator = new DocumentGeneratorAgent();
    const result = await documentGenerator.generateDocument(type, data);
    
    // Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµĞ¼ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°
    console.log('Document generation:', {
      userId,
      type,
      timestamp: new Date().toISOString(),
    });
    
    return NextResponse.json({
      content: result.content,
      metadata: result.metadata,
    });
  } catch (error) {
    console.error('Document generation error:', error);
    return NextResponse.json(
      { error: 'Failed to generate document' },
      { status: 500 }
    );
  }
}
```

### **6. Frontend Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ**

#### **AI Chat Component**
```typescript
// src/components/features/ai-chat/AIChat.tsx
'use client';

import { useState, useRef, useEffect } from 'react';
import { useTelegram } from '@/lib/telegram/telegram-provider';

interface Message {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: Date;
  confidence?: number;
  sources?: string[];
}

export const AIChat = () => {
  const { user } = useTelegram();
  const [messages, setMessages] = useState<Message[]>([]);
  const [input, setInput] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);
  
  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };
  
  useEffect(() => {
    scrollToBottom();
  }, [messages]);
  
  const sendMessage = async () => {
    if (!input.trim() || isLoading) return;
    
    const userMessage: Message = {
      id: Date.now().toString(),
      role: 'user',
      content: input,
      timestamp: new Date(),
    };
    
    setMessages(prev => [...prev, userMessage]);
    setInput('');
    setIsLoading(true);
    
    try {
      const response = await fetch('/api/ai/consultation', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          query: input,
          userId: user?.id,
        }),
      });
      
      const data = await response.json();
      
      const assistantMessage: Message = {
        id: (Date.now() + 1).toString(),
        role: 'assistant',
        content: data.advice,
        timestamp: new Date(),
        confidence: data.confidence,
        sources: data.sources,
      };
      
      setMessages(prev => [...prev, assistantMessage]);
    } catch (error) {
      console.error('Failed to send message:', error);
      
      const errorMessage: Message = {
        id: (Date.now() + 1).toString(),
        role: 'assistant',
        content: 'Ğ˜Ğ·Ğ²Ğ¸Ğ½Ğ¸Ñ‚Ğµ, Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ°. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.',
        timestamp: new Date(),
      };
      
      setMessages(prev => [...prev, errorMessage]);
    } finally {
      setIsLoading(false);
    }
  };
  
  return (
    <div className="flex flex-col h-full">
      <div className="flex-1 overflow-y-auto p-4 space-y-4">
        {messages.map((message) => (
          <div
            key={message.id}
            className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}
          >
            <div
              className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${
                message.role === 'user'
                  ? 'bg-telegram-button text-telegram-button-text'
                  : 'bg-telegram-secondary text-telegram-text'
              }`}
            >
              <p className="text-sm">{message.content}</p>
              {message.confidence && (
                <p className="text-xs opacity-70 mt-1">
                  Ğ£Ğ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ: {Math.round(message.confidence * 100)}%
                </p>
              )}
              {message.sources && message.sources.length > 0 && (
                <p className="text-xs opacity-70 mt-1">
                  Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸: {message.sources.join(', ')}
                </p>
              )}
            </div>
          </div>
        ))}
        {isLoading && (
          <div className="flex justify-start">
            <div className="bg-telegram-secondary text-telegram-text px-4 py-2 rounded-lg">
              <p className="text-sm">Ğ”ÑƒĞ¼Ğ°Ñ...</p>
            </div>
          </div>
        )}
        <div ref={messagesEndRef} />
      </div>
      
      <div className="p-4 border-t border-telegram-secondary">
        <div className="flex space-x-2">
          <input
            type="text"
            value={input}
            onChange={(e) => setInput(e.target.value)}
            onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
            placeholder="Ğ—Ğ°Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ Ğ¾ Ğ²Ğ°ÑˆĞ¸Ñ… Ğ¿Ñ€Ğ°Ğ²Ğ°Ñ…..."
            className="flex-1 px-3 py-2 border border-telegram-secondary rounded-lg bg-telegram-bg text-telegram-text focus:outline-none focus:ring-2 focus:ring-telegram-button"
            disabled={isLoading}
          />
          <button
            onClick={sendMessage}
            disabled={!input.trim() || isLoading}
            className="px-4 py-2 bg-telegram-button text-telegram-button-text rounded-lg disabled:opacity-50"
          >
            ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ
          </button>
        </div>
      </div>
    </div>
  );
};
```

---

## ğŸ“Š ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°

### **1. AI Metrics**
```typescript
// src/lib/ai/analytics.ts
export class AIAnalytics {
  static trackConsultation(
    userId: string,
    query: string,
    response: string,
    confidence: number,
    responseTime: number
  ) {
    // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ² Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºÑƒ
    fetch('/api/analytics/ai-consultation', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        userId,
        queryLength: query.length,
        responseLength: response.length,
        confidence,
        responseTime,
        timestamp: new Date().toISOString(),
      }),
    });
  }
  
  static trackDocumentGeneration(
    userId: string,
    type: string,
    success: boolean,
    generationTime: number
  ) {
    fetch('/api/analytics/document-generation', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        userId,
        type,
        success,
        generationTime,
        timestamp: new Date().toISOString(),
      }),
    });
  }
}
```

### **2. Error Handling**
```typescript
// src/lib/ai/error-handler.ts
export class AIErrorHandler {
  static handleError(error: any, context: string) {
    console.error(`AI Error in ${context}:`, error);
    
    // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ² ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°
    fetch('/api/errors/ai-error', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        context,
        error: error.message,
        stack: error.stack,
        timestamp: new Date().toISOString(),
      }),
    });
  }
  
  static getFallbackResponse(context: string): string {
    const fallbacks = {
      consultation: 'Ğ˜Ğ·Ğ²Ğ¸Ğ½Ğ¸Ñ‚Ğµ, Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ Ğ½Ğµ Ğ¼Ğ¾Ğ³Ñƒ Ğ¿Ñ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½ÑÑƒĞ»ÑŒÑ‚Ğ°Ñ†Ğ¸Ñ. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ·Ğ¶Ğµ Ğ¸Ğ»Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ¸Ñ‚ĞµÑÑŒ Ğº ÑÑ€Ğ¸ÑÑ‚Ñƒ.',
      document: 'Ğ˜Ğ·Ğ²Ğ¸Ğ½Ğ¸Ñ‚Ğµ, Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ Ğ½Ğµ Ğ¼Ğ¾Ğ³Ñƒ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ·Ğ¶Ğµ.',
      default: 'ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ°. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.',
    };
    
    return fallbacks[context as keyof typeof fallbacks] || fallbacks.default;
  }
}
```

---

## ğŸ”’ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### **1. Rate Limiting**
```typescript
// src/lib/ai/rate-limiter.ts
export class AIRateLimiter {
  private static requests = new Map<string, number[]>();
  
  static async checkLimit(userId: string, limit: number = 10, windowMs: number = 60000): Promise<boolean> {
    const now = Date.now();
    const userRequests = this.requests.get(userId) || [];
    
    // Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ ÑÑ‚Ğ°Ñ€Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
    const recentRequests = userRequests.filter(time => now - time < windowMs);
    
    if (recentRequests.length >= limit) {
      return false;
    }
    
    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
    recentRequests.push(now);
    this.requests.set(userId, recentRequests);
    
    return true;
  }
}
```

### **2. Input Validation**
```typescript
// src/lib/ai/input-validator.ts
import { z } from 'zod';

export const consultationSchema = z.object({
  query: z.string()
    .min(10, 'Ğ’Ğ¾Ğ¿Ñ€Ğ¾Ñ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 10 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²')
    .max(1000, 'Ğ’Ğ¾Ğ¿Ñ€Ğ¾Ñ Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞ°Ñ‚ÑŒ 1000 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²')
    .refine(
      (query) => !query.includes('Ğ²Ğ·Ğ»Ğ¾Ğ¼') && !query.includes('Ñ…Ğ°Ğº'),
      'ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚'
    ),
  userId: z.string().uuid(),
});

export const documentSchema = z.object({
  type: z.enum(['claim', 'complaint', 'contract']),
  data: z.record(z.any()),
  userId: z.string().uuid(),
});
```

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### **1. Unit Tests**
```typescript
// tests/lib/ai/legal-advisor-agent.test.ts
import { LegalAdvisorAgent } from '@/lib/ai/agents/legal-advisor-agent';

describe('LegalAdvisorAgent', () => {
  let agent: LegalAdvisorAgent;
  
  beforeEach(() => {
    agent = new LegalAdvisorAgent();
  });
  
  it('should provide legal advice for consumer rights question', async () => {
    const query = 'ĞŸÑ€Ğ¾Ğ´Ğ°Ğ²ĞµÑ† Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ° Ğ² Ñ‚ĞµÑ‡ĞµĞ½Ğ¸Ğµ 14 Ğ´Ğ½ĞµĞ¹';
    
    const result = await agent.provideLegalAdvice(query);
    
    expect(result.advice).toBeDefined();
    expect(result.confidence).toBeGreaterThan(0);
    expect(result.sources).toBeDefined();
  });
  
  it('should handle empty query', async () => {
    await expect(agent.provideLegalAdvice('')).rejects.toThrow();
  });
});
```

### **2. Integration Tests**
```typescript
// tests/api/ai/consultation.test.ts
import { POST } from '@/app/api/ai/consultation/route';
import { NextRequest } from 'next/server';

describe('/api/ai/consultation', () => {
  it('should return legal advice', async () => {
    const request = new NextRequest('http://localhost:3000/api/ai/consultation', {
      method: 'POST',
      body: JSON.stringify({
        query: 'ĞœĞ¾Ğ³Ñƒ Ğ»Ğ¸ Ñ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ñ‚Ğ¾Ğ²Ğ°Ñ€ Ğ±ĞµĞ· Ñ‡ĞµĞºĞ°?',
        userId: 'test-user-id',
      }),
    });
    
    const response = await POST(request);
    const data = await response.json();
    
    expect(response.status).toBe(200);
    expect(data.advice).toBeDefined();
    expect(data.confidence).toBeDefined();
  });
});
```

---

## ğŸ“ˆ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

### **1. Caching Ñ TimeWeb Cloud**
```typescript
// src/lib/ai/timeweb-cache.ts
import axios from 'axios';

export class TimeWebAICache {
  private apiKey: string;
  private baseUrl: string;
  
  constructor() {
    this.apiKey = process.env.TIMEWEB_API_KEY!;
    this.baseUrl = process.env.TIMEWEB_API_URL || 'https://api.timeweb.cloud';
  }
  
  async getCachedResponse(query: string): Promise<string | null> {
    try {
      const key = `ai:consultation:${Buffer.from(query).toString('base64')}`;
      const response = await axios.get(`${this.baseUrl}/v1/cache/get`, {
        params: { key },
        headers: {
          'Authorization': `Bearer ${this.apiKey}`,
        },
      });
      
      return response.data.value || null;
    } catch (error) {
      console.error('TimeWeb cache get error:', error);
      return null;
    }
  }
  
  async setCachedResponse(query: string, response: string, ttl: number = 3600): Promise<void> {
    try {
      const key = `ai:consultation:${Buffer.from(query).toString('base64')}`;
      await axios.post(`${this.baseUrl}/v1/cache/set`, {
        key,
        value: response,
        ttl,
      }, {
        headers: {
          'Authorization': `Bearer ${this.apiKey}`,
          'Content-Type': 'application/json',
        },
      });
    } catch (error) {
      console.error('TimeWeb cache set error:', error);
    }
  }
}
```

### **2. Batch Processing**
```typescript
// src/lib/ai/batch-processor.ts
export class AIBatchProcessor {
  private queue: Array<{ query: string; resolve: Function; reject: Function }> = [];
  private processing = false;
  
  async addToQueue(query: string): Promise<string> {
    return new Promise((resolve, reject) => {
      this.queue.push({ query, resolve, reject });
      this.processQueue();
    });
  }
  
  private async processQueue() {
    if (this.processing || this.queue.length === 0) return;
    
    this.processing = true;
    
    while (this.queue.length > 0) {
      const batch = this.queue.splice(0, 5); // ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¿Ğ¾ 5 Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
      
      try {
        const responses = await Promise.all(
          batch.map(item => this.processQuery(item.query))
        );
        
        batch.forEach((item, index) => {
          item.resolve(responses[index]);
        });
      } catch (error) {
        batch.forEach(item => item.reject(error));
      }
    }
    
    this.processing = false;
  }
  
  private async processQuery(query: string): Promise<string> {
    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
    return 'Response';
  }
}
```

---

## ğŸ¯ Ğ—Ğ°ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ

AI Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² LawerApp Telegram Mini App Ñ TimeWeb Cloud Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ğ²Ğ°ĞµÑ‚:

- âœ… **ĞšĞ°Ñ‡ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ½ÑÑƒĞ»ÑŒÑ‚Ğ°Ñ†Ğ¸Ğ¸** - RAG ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ²Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ğ¾Ğ¹ Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹ Ğ½Ğ° TimeWeb Cloud
- âœ… **ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²** - ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ AI Ğ°Ğ³ĞµĞ½Ñ‚Ñ‹
- âœ… **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ** - ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ batch processing Ñ‡ĞµÑ€ĞµĞ· TimeWeb Cloud
- âœ… **Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ** - rate limiting Ğ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- âœ… **ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³** - Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
- âœ… **Ğ Ğ¾ÑÑĞ¸Ğ¹ÑĞºĞ°Ñ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°** - Ğ²ÑĞµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾ÑÑ‚Ğ°ÑÑ‚ÑÑ Ğ² Ğ Ğ¾ÑÑĞ¸Ğ¸

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³:** ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ²Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ñ‹ Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹ Ğ² TimeWeb Cloud Ğ¸ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ AI Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ²! ğŸš€

---

*AI Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ»ĞµĞ½Ğ°: 16 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ 2025*  
*Ğ’ĞµÑ€ÑĞ¸Ñ: 1.0*  
*Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ âœ…*
